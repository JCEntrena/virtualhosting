% !TeX spellcheck = <none>

%%%%
% Modificaci�n de una plantilla de Latex para adaptarla al castellano.
%%%

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Thin Sectioned Essay
% LaTeX Template
% Version 1.0 (3/8/13)
%
% This template has been downloaded from:
% http://www.LaTeXTemplates.com
%
% Original Author:
% Nicolas Diaz (nsdiaz@uc.cl) with extensive modifications by:
% Vel (vel@latextemplates.com)
%
% License:
% CC BY-NC-SA 3.0 (http://creativecommons.org/licenses/by-nc-sa/3.0/)
%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%----------------------------------------------------------------------------------------
%	PACKAGES AND OTHER DOCUMENT CONFIGURATIONS
%----------------------------------------------------------------------------------------

\documentclass[a4paper, 10pt]{article} % Font size (can be 10pt, 11pt or 12pt) and paper size (remove a4paper for US letter paper)

\usepackage[protrusion=true,expansion=true]{microtype} % Better typography
\usepackage{graphicx} % Required for including pictures
\usepackage[usenames,dvipsnames]{color} % Coloring code
\usepackage{wrapfig} % Allows in-line images
\usepackage[utf8]{inputenc}
\usepackage{enumerate}
\usepackage{enumitem}

\usepackage{geometry}
 \geometry{
 a4paper,
 total={210mm,297mm},
 left=3cm,
 right=3cm,
 top=25mm,
 bottom=25mm,
 }

% Imagenes
\usepackage{graphicx} 

\usepackage{amsmath}
% para importar svg
%\usepackage[generate=all]{svgfig}

% sudo apt-get install texlive-lang-spanish
\usepackage[spanish]{babel} % English language/hyphenation
\selectlanguage{spanish}
% Hay que pelearse con babel-spanish para el alineamiento del punto decimal
\decimalpoint
\usepackage{dcolumn}
\newcolumntype{d}[1]{D{.}{\esperiod}{#1}}
\makeatletter
\addto\shorthandsspanish{\let\esperiod\es@period@code}
\makeatother

\usepackage{longtable}
\usepackage{tabu}
\usepackage{supertabular}

\usepackage{multicol}
\newsavebox\ltmcbox

% Símbolos matemáticos
\usepackage{amssymb}
\let\oldemptyset\emptyset
\let\emptyset\varnothing

% Fuente Arial
\renewcommand{\rmdefault}{phv} % Arial
\renewcommand{\sfdefault}{phv} % Arial



%URL's 
\usepackage{url}

\usepackage[section]{placeins} % Para gr�ficas en su secci�n.
\usepackage{mathpazo} % Use the Palatino font
\usepackage[T1]{fontenc} % Required for accented characters
\newenvironment{allintypewriter}{\ttfamily}{\par}
\setlength{\parindent}{0pt}
\parskip=8pt
\linespread{1.05} % Change line spacing here, Palatino benefits from a slight increase by default

\makeatletter
\renewcommand\@biblabel[1]{\textbf{#1.}} % Change the square brackets for each bibliography item from '[1]' to '1.'
\renewcommand{\@listI}{\itemsep=0pt} % Reduce the space between items in the itemize and enumerate environments and the bibliography
\newcommand{\imagen}[2]{\begin{center} \includegraphics[width=90mm]{#1} \\#2 \end{center}}


\usepackage[hidelinks]{hyperref}

  % Para las enumeraciones anidadas y sus referencias, basado en http://stackoverflow.com/questions/691351/how-to-customize-references-to-sublists-in-latex
  \renewcommand{\theenumi}{\arabic{enumi}.}
  \renewcommand{\theenumii}{\arabic{enumii}}
  \renewcommand{\theenumiii}{\arabic{enumiii}}
  
  \renewcommand{\labelenumi}{\theenumi}
  \renewcommand{\labelenumii}{\theenumi\theenumii.}
  \renewcommand{\labelenumiii}{\theenumi\theenumii.\theenumiii.}
  
  \makeatletter
  \renewcommand{\p@enumii}{\theenumi}
  \renewcommand{\p@enumiii}{\theenumi\theenumii.}
%------------------------------------------------
%	TITLE
%------------------------------------------------

\title{\textbf{Hosting Virtual}} % Title

\date{\today} % Date

%------------------------------------------------

\begin{document}

\maketitle
\tableofcontents
\pagebreak

\section{Resumen}

En este trabajo vamos a tratar sobre el hosting virtual y su implementación en un servidor apache. Inicialmente presentaremos el concepto de hosting virtual y sus diferentes opciones y usos, continuando con el servidor apache, del cual trataremos los conceptos básicos y enlazaremos con el hosting virtual. Analizaremos y comprobaremos las diferentes opciones que nos ofrece apache para ofrecer este tipo de servicio, explicando las alternativas y las ventajas que nos ofrece cada una de ellas. Trataremos también distintos aspectos a tener en cuenta a la hora de usar hosting virtual en un servidor, tales como la seguridad, y veremos qué opciones nos permite apache para configurar dichos aspectos. 


\section{Memoria}

\subsection{Introducción}

El alojamiento de contenido en internet ha ido evolucionando a lo largo de los años. Inicialmente se tenían estaciones de trabajo, que había que gestionar y mantener desde el mismo lugar en el que estaban. Para tener un sitio web propio había que tener un ordenador o un servidor que alojase y sirviera la página, ya que el negocio del alojamiento web no estaba todavía explotado. Poco a poco, las estaciones de trabajo fueron creciendo en tamaño, llegando así los datacenters, que introdujeron ciertas ventajas, como la seguridad física de la infraestructura. Este tipo de almacenamiento se sigue usando hoy en día, sobre todo por grandes compañías que requieren tener almacenada una cantidad de información masiva, como por ejemplo Google (ver [1] para más información sobre los datacenters de Google). Al aumentar la capacidad de almacenamiento y procesamiento de los servidores, el uso de estos como una nueva forma de negocio fue instaurándose en el mundo de la informática; empiezan a surgir empresas que alquilan recursos a aquellas personas que quieren tener su propia página web sin necesidad de que tengan que montar la estructura en casa, lo que les ahorra trabajo, mantenimiento y una cantidad de dinero considerable. 

Después del boom que supusieron los datacenters, estos pronto empezaron a tener un tamaño descomunal, complicando su mantenimiento e incluso almacenamiento, pues estos se encontraban en lugares gigantescos. Así, poco a poco, la virtualización fue abriendose paso como tecnología emergente. La virtualización ofrece una capa de abstracción entre software y hardware, proporcionando beneficios tales como el aislamiento entre aplicaciones, un mayor aprovechamiento del hardware disponible y una mejora del mantenimiento. Aquí entra en juego el término 'Virtual Hosting', en castellano 'almacenamiento virtual', que tratará sobre las diferentes posibilidades de almacenamiento web en estos servidores virtuales. 

\subsubsection{Tecnología posterior: Cloud Computing}

Sin embargo esta tecnología también vería aparecer los mismos problemas que sus predecesoras, estando atadas a un almacenamiento en un lugar físico. Es aquí donde aparece el denominado 'Cloud Computing' o almacenamiento en la nube. Su presencia en este sector ha ido aumentando a pasos agigantados, apoyada gracias al uso que le han dado grandes compañías como Amazon, Google y Microsoft, de quienes emergió una arquitectura que se ha mantenido hasta hoy.  \\
El almacenamiento en la nube se fundamenta en la oferta de servicios, de forma que el usuario accede a los recursos de internet mediante ellos sin tener que adquirir ningun tipo de hardware, manejar licencias software ni conocer a fondo la gestión de los mismos [2]. Para atender todas las peticiones de servicios existen servidores desde internet encargados de ellas, teniendo acceso a ellos únicamente con tener conexión a internet. Se servirá a los usuarios desde varios proveedores repartidos por todo el mundo, lo que permite una mejora del tiempo de actividad.

Sin embargo, no todo lo referente al almacenamiento en la nube es bueno. Han surgido diversas críticas, sobre todo relativas a la privacidad de los datos alojados, pues estos quedan expuestos a terceros que pueden acceder a ellos y copiarlos. Richard Stallman fue uno de los que levantó la voz, diciendo que la nube exponía a los usuarios y que era una trampa para que la gente adquiriera cada vez más servicios.\footnote{\url{http://www.theguardian.com/technology/2008/sep/29/cloud.computing.richard.stallman}} Otros problemas pueden ser la interdependencia entre proveedores web y la necesidad de conexión a internet para acceder a todo, lo que en caso de necesitar los datos en todo momento puede comprometernos en algunas situaciones. Este almacenamiento de datos que puedan ser sensibles e importantes en un lugar remoto puede dar lugar a problemas adicionales, sobre todo en empresas y grandes organizaciones.\footnote{\url{http://es.wikipedia.org/wiki/Computaci\%C3\%B3n_en_la_nube} \\ \url{http://www.artifactconsulting.com/lapeira/2011/02/28/motivos-para-rechazar-el-cloud-computing/}}

La nube es bastante joven aun, por lo que le queda un desarrollo importante a lo largo de los próximos años. Poco a poco irá cambiando y aumentando la infraestructura de la nube, gracias a la inversión de las empresas que ya se encuentran en ella y a la llegada de nuevas.\footnote{\url{http://www.hansoninc.com/the-evolution-of-web-hosting/}\\ \url{http://ticsyformacion.com/2012/02/13/la-evolucion-del-web-hosting-infografia-infographic-internet/}}

\subsection{Virtual Hosting}

El concepto de Virtual Hosting se refiere al método para alojar múltiples dominios en un único servidor, lo que permite a dicho servidor compartir su funcionalidad entre los distintos dominios, como por ejemplo la memoria o el procesador. Uno de sus principales usos es el almacenamiento web compartido, un servicio donde cada sitio web ocupa una parte del servidor, que está contectado a internet. Es la forma de almacenamiento más económica, pues permite a todo aquel que quiera tener una página web alojarla a un precio mucho más barato que si tuviera que alquilar un servidor completo, ya que se reparten los gastos de mantenimiento y alquiler del servidor entre todos los usuarios. 

Gracias a esto también se permite un mayor aprovechamiento de los servidores, los cuales tienen cada vez más capacidad de cómputo y podrían quedar desaprovechados si únicamente alojasen una web. 

Sin embargo, no son todo ventajas en el hosting virtual. Debido al alojamiento compartido, es común que aparezcan fallos de seguridad, normalmente debidos a que el servidor tiene múltiples administradores independientes que trabajan con herramientas distintas, creando dificultades en el mantenimiento de los programas que se ejecutan en el servidor. Además, a causa del reparto de recursos, se crea una dependencia con los compañeros de servidor, ya que estos pueden sobrecargarlo, provocando una bajada en el rendimiento de nuestra propia web. En general, podemos decir que estamos fuertemente condicionados por lo que nuestros vecinos hagan en el servidor, tanto en materia de seguridad como de recursos. 

Centrándonos ahora en el hosting virtual, tenemos distintos tipos a diferenciar, de los cuales destacan dos: basado en nombre (name-based) y en IP (IP-based), aunque también existe una versión basada en puertos(port-based), si bien es más extraña. Vamos a hablar un poco de ellas en detalle: 

\underline{Name-based:} Esta opción almacena hosts con distintos nombre pero que comparten la misma IP. De esta forma, podríamos tener dos páginas, www.ejemplo.com y www.ejemplo.org compartiendo IP pero distintas entre sí (y con almacenamientos distintos). En esta opción se nos presenta un problema con las DNS, ya que si estas no funcionan debidamente resulta imposible acceder a la página web, aun conociendo la IP. Por norma general, si intentamos acceder directamente mediante la IP el servidor responderá con una página web por defecto, que usualmente no es a la que el usuario quiere acceder. \\
Existen ciertos problemas de seguridad adicionales si utilizamos este tipo de alojamiento, pero los trataremos más adelante. 

\underline{IP-based:} En esta opción cada página web tendrá una IP única para sí misma. Es menos problemático en cuanto al acceso, pues cada web es distinta a las demás y se gestiona por separado, aunque aumenta un poco la carga del servidor, que tiene que escuchar distintas IP's, si bien esto no es significativo en gran medida. 

Estas dos técnicas pueden ser combinadas dentro de un servidor, no teniendo que restringirse únicamente a una de las dos. 

Generalmente, para alojar nuestra página web, necesitaremos un servidor web, como pueden ser Apache, IIS o nginx, un servidor de bases de datos, como MySQL, servicios FTP y SSH para transferencia de archivos y control remoto y de correo a nivel de servidor. 

\subsection{Apache}

El servidor web Apache\footnote{Para acortar, nos referiremos a él simplemente como 'Apache'.} es un servidor web HTTP de código abierto, siendo actualmente el más utilizado en todo el mundo.\footnote{Podemos ver estadísticas de uso en \url{http://news.netcraft.com/archives/2015/04/20/april-2015-web-server-survey.html\#more-18965}} Actualmente se encuentra en su versión 2.4.12. 

Apache es un producto de la Apache Software Fundation, que se inició en el año 1995. La propia fundación lo presenta de la siguiente forma: \textit{'El servidor HTTP Apache es un servidor HTTP de código abierto para sistemas operativos modernos, incluyendo UNIX, Microsoft Windows, Mac OS/X y Netware. El objetivo de este proyecto es el de proveer un servidor seguro, eficiente y extensible que proporciona servicio HTTP de acuerdo a los estándares HTTP actuales. Apache ha sido el servidor web más popular en internet desde Abril de 1996.'}\footnote{http://httpd.apache.org/}

En el desarrollo de este trabajo trabajaremos con Apache instalado en Ubuntu 14.04. Para instalarlo, únicamente tenemos que ejecutar la orden 'sudo apt-get install apache2'. En caso de tener otro gestor de paquetes distinto a apt, el proceso a seguir es el mismo, con la orden correspondiente para dicho gestor y el paquete apache2. Para Windows, tenemos distintas aplicaciones que nos permiten usar Apache, tales como Apache Haus o WampServer, el cual incluye también MySQL y PHP, proporcionando lo conocido como WAMP: Windows, Apache, MySQL y PHP. En mi caso, al trabajar en Ubuntu, tengo instalado LAMP, si bien puede que no sea necesaria toda su funcionalidad en el desarrollo del trabajo. 


\subsection{Configuración general de Apache}

% % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % %
%La parte importante del trabajo. Virtual Hosting en Apache. Comentar que no se pueden hacer experimentos a gran escala pues conllevaría alquilar un servidor, crear una web y monitorizarla. 
% % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % %

En este apartado vamos a hablar de la configuración de Apache en Ubuntu, inicialmente de forma general y después centrada en la configuración necesaria para proporcionar un servicio de hosting virtual. 

Una vez realizada la instalación de Apache, tendremos todo lo relacionado con el servidor web en el directorio /etc/apache2. Aquí será donde tengamos todos los archivos de configuración de Apache, como por ejemplo apache2.conf o ports.conf. Cada archivo es relativo a una característica del servidor, y deberemos modificarlos para obtener los resultados que buscamos. Como las modificaciones serán numerosas, indicaré en todo momento que archivo de configuración estoy modificando. 

El archivo principal de configuración es apache2.conf. Aquí tendremos la configuración general del servidor: dónde tenemos el directorio raíz, qué archivos de configuración adicionales estamos utilizando (como podría ser el archivo de configuración de puertos), parámetros para la conexión, etc. 

Para la configuración de los puertos de escucha, tenemos un archivo inicial que es ports.conf. Su formato es muy sencillo, simplemente hemos de indicarle los puertos que queremos escuchar con la línea 'Listen X', donde X es el número de puerto. Por defecto se escucha al puerto 80, y si tenemos posibilidad de conexión segura mediante SSL se escucha también el puerto 443 (para conexiones HTTPS). Si quisiéramos añadir más puertos podemos hacerlo añadiendo manualmente la línea indicada anteriormente. 

\subsection{Configuración enfocada al hosting virtual}

La carpeta sites-enabled tendrá mucha importancia para nosotros. Dentro de esta, se encuentra el archivo de configuración 000-default.conf, que nos permite definir las páginas web que tendremos. Por defecto únicamente tenemos una entrada, que escuchará un host virtual. Está especificado de la siguiente forma: 

<VirtualHost *:80> \\
	\# ServerName www.example.com\\
	DocumentRoot /var/www \\
	...\\
</VirtualHost>\\

Al declarar el nuevo host, le indicaremos la IP y el puerto o puertos en los que escucha. En este caso estamos diciendo que cualquier IP es válida, y que escuche al puerto 80. Sin embargo, esto no hace que el servidor redirija toda petición a la carpeta. Podemos ver el siguiente mensaje que aparece al iniciar el servicio apache: \\
\textit{'apache2: Could not reliably determine the server's fully qualified domain name, using 127.0.1.1. Set the 'ServerName' directive globally to suppress this message'}

Este mensaje nos dice que, al no haber determinado un nombre para el servidor (pues tenemos la línea ServerName comentada, que es la que se encarga de hacerlo), solo se tendrán en consideración las peticiones hechas a la IP 127.0.1.1. La línea DocumentRoot nos indica el directorio raíz que almacenará los archivos para nuestra página web. Tenemos más opciones de configuración que podemos añadir aquí, tales como el correo del administrador del servidor, para el que usaremos la orden ServerAdmin dirección-de-correo y para el tratamiento de errores, ErrorLog y CustomLog. Como no son relevantes para este trabajo, no profundizaremos en ellos. 

¿Qué hemos de hacer si queremos añadir nuevos hosts virtuales? 

Cada host virtual que queramos añadir quedará determinado en el archivo de configuración 000-default.conf de la carpeta sites-enabled, que especifica las webs que estaremos utilizando. Por normal general, cada nuevo host que añadamos tendrá su configuración entre las líneas <VirtualHost IP:Port> y </VirtualHost>. Dicha configuración dependerá del tipo de hosting virtual que queramos (IP-based o Name-based), por lo que distinguiremos entre ambos casos y los analizaremos con profundidad. 

\subsubsection{IP-based}

Si queremos tener almacenamiento compartido basado en IP, la combinación IP-Puerto de cada host virtual debe ser diferente. Como se comenta en la documentación de Apache\footnote{\url{http://httpd.apache.org/docs/2.4/en/vhosts/ip-based.html}}, \textit{'en terminología del servidor HTTP Apache, usar una única IP con múltiples puertos TCP está considerado hosting virtual basado en IP.'}

Hablar de qué hay que tocar en los archivos de configuración puede ser buena idea, y quizás hacer alguna prueba en local. 

Diferenciación entre basados en nombre y basados en IP. 
	- Cómo los trata apache. 
	- Ejemplos de cada uno, abordando todas las posibilidades. 

Hablar de la seguridad en apache y como afecta al virtual hosting en particular. Proponer soluciones para problemas que se puedan dar. 

Permitir multiples sitios seguros: Server Name Indication 

\section{Bibliografía}

[1] Centros de datos de Google - \url{http://www.google.com/about/datacenters/}

[2] Cloud Computing - \url{http://web.archive.org/web/20120915111539/http://www.itnews.ec/news/000396.aspx}

\section{Aparte. Ideas para la presentación. Preguntas.}
\begin{itemize}
\item Almacenamientos a lo largo de la historia. 
\item Tipos de hosting virtual. Tanto para presentación como para preguntas. 
\end{itemize}

\end{document}